### 1.6 如何寻找拉格朗日量

拉格朗日方程是一个二阶微分方程组。为了用它们来计算一个力学系统的演化，我们必须为该系统找到一个合适的拉格朗日量。

并没有一个通用的方法可以为所有系统构造拉格朗日量，但对于一个重要类型的系统，我们可以用一种直截了当的方式，通过**动能 (kinetic energy)** 和**势能 (potential energy)** 来确定拉格朗日量。其关键思想是构造一个拉格朗日量 $L$，使得拉格朗日方程等价于牛顿方程 $\vec{F} = m\vec{a}$。

假设我们的系统由 $N$ 个粒子（索引为 $\alpha$）组成，它们各自的质量为 $m_\alpha$，矢量位置为 $\vec{x}_\alpha(t)$。再假设作用在粒子上的力可以写成一个**势能** $\mathcal{V}$ 的**梯度** (gradient)，该势能是粒子位置的函数，也可能与时间相关，但**不依赖于速度**。

换句话说，作用在粒子 $\alpha$ 上的力是 $\vec{F}_\alpha = -\vec{\nabla}_{\vec{x}_\alpha} \mathcal{V}$，其中 $\vec{\nabla}_{\vec{x}_\alpha} \mathcal{V}$ 是 $\mathcal{V}$ 相对于粒子 $\alpha$ 位置的梯度。我们可以将牛顿方程写为：

$$
D(m_\alpha D\vec{x}_\alpha)(t) + \vec{\nabla}_{\vec{x}_\alpha} \mathcal{V}(t, \vec{x}_0(t), \dots, \vec{x}_{N-1}(t)) = 0.
\tag{1.53}
$$
向量可以表示为它们在一个直角坐标基上的分量元组。所以 $\vec{x}_1(t)$ 可以表示为元组 $x_1(t)$。设 $V$ 是用分量表示的势能函数：

$$
V(t; x_0(t), \dots, x_{N-1}(t)) = \mathcal{V}(t, \vec{x}_0(t), \dots, \vec{x}_{N-1}(t)).
\tag{1.54}
$$
牛顿方程 (1.53) 的分量形式是：

$$
D(m_\alpha D x_\alpha)(t) + \partial_{1,\alpha} V(t; x_0(t), \dots, x_\alpha(t), \dots, x_{N-1}(t)) = 0,
\tag{1.55}
$$
其中 $\partial_{1,\alpha} V$ 是 $V$ 对其 $x_\alpha(t)$ 参数槽的偏导数。

为了构建拉格朗日方程，我们将所有粒子的所有位置分量收集到一个元组 $x(t)$ 中，即 $x(t) = (x_0(t), \dots, x_{N-1}(t))$。坐标路径 $x$ 的拉格朗日方程是：

$$
D(\partial_2 L \circ \Gamma[x]) - \partial_1 L \circ \Gamma[x] = 0.
\tag{1.56}
$$
观察发现，如果我们选择的 $L$ 具有以下性质，那么牛顿方程 (1.55) 正好是拉格朗日方程 (1.56) 的各个分量：

$$
\partial_{1,\alpha} (L \circ \Gamma[x]) = -\partial_{1,\alpha} V (t, x(t))
\tag{1.57a}
$$
$$
D(\partial_{2,\alpha} (L \circ \Gamma[x])) = D(m_\alpha D x_\alpha)(t),
\tag{1.57b}
$$
这里 $V (t, x(t)) = V (t; x_0(t), \dots, x_{N-1}(t))$，而 $\partial_{1,\alpha} V (t, x(t))$ 是 $V$ 相对于粒子 $\alpha$ 坐标的导数（以元组形式表示），并在时间 $t$ 和坐标 $x(t)$ 处求值。

如果对于每一个 $x_\alpha$ 和 $v_\alpha$ 都有：

$$
\partial_{1,\alpha} L(t, x, v) = -\partial_{1,\alpha} V (t, x)
\tag{1.58}
$$
并且

$$
\partial_{2,\alpha} L(t, x, v) = m_\alpha v_\alpha
\tag{1.59}
$$
其中 $x = (x_0, \dots, x_{N-1})$，那么条件 (1.57) 就被满足。
满足所需性质 (1.58–1.59) 的一个 $L$ 的选择是：

$$
L(t, x, v) = \frac{1}{2} \sum_\alpha m_\alpha v_\alpha^2 - V(t, x),
\tag{1.60}
$$
其中 $v_\alpha^2$ 是 $v_\alpha$ 各分量的平方和。⁵⁹

第一项是**动能**，通常记为 $T$。因此，这个拉格朗日量的选择是 $L(t, x, v) = T(t, x, v) - V(t, x)$，即**动能与势能之差**。我们经常会将势能函数的参数扩展以包含速度，这样我们就可以写作 $L = T - V$。⁶⁰

-----

#### **哈密顿原理 (Hamilton’s principle)**

给定一个点粒子系统，如果我们可以确定其力是某个不依赖于速度的势能 $V$ 的（负）导数，我们就证明了该系统会沿着一条满足拉格朗日方程（其中 $L = T - V$）的路径演化。

在为这类系统确定了拉格朗日量之后，我们可以用能量来重述平稳作用量原理。这个表述被称为**哈密顿原理** (Hamilton’s principle)：

> 对于一个力可以从不依赖于速度的势能导出的点粒子系统，其演化路径 $q$ 会使**作用量** $S[q](t_1, t_2) = \int_{t_1}^{t_2} L \circ \Gamma[q]$ 相对于保持端点固定的路径变分为**平稳**，其中 $L = T - V$ 是动能与势能之差。⁶¹

看起来我们似乎把拉格朗日方程简化得不过是 $\vec{F} = m\vec{a}$，而事实上，该原理正是通过比较这两种方程在这一特殊系统类别中的表现而受到启发的。然而，运动方程的拉格朗日表述相比 $\vec{F} = m\vec{a}$ 有一个重要优势。

我们的推导使用了组元粒子位置的直角坐标分量 $x_\alpha$ 作为广义坐标，但是，如果系统的路径在某个特定坐标系中满足拉格朗日方程，它**必须在任何坐标系中都满足这些方程**。因此，我们看到 $L = T - V$ 适合作为**任何**广义坐标系下的拉格朗日量。

变分力学的方程在任何位形空间和任何坐标系中都以相同的方式推导得出。相比之下，牛顿表述是基于初等几何的：为了使 $D^2 \vec{x}(t)$ 作为加速度有意义，$\vec{x}(t)$ 必须是物理空间中的一个向量。拉格朗日方程对坐标 $q$ 的含义没有这样的限制。广义坐标可以是任何能方便描述系统位形的参数。

-----

#### **示例：匀加速运动 (Constant acceleration)**

考虑一个质量为 $m$ 的粒子处于加速度为 $g$ 的匀强重力场中。势能是 $mgh$，其中 $h$ 是粒子的高度。动能就是 $\frac{1}{2} m v^2$。该系统的一个拉格朗日量是动能与势能之差。在直角坐标系中，设 $y$ 测量竖直位置，$x$ 测量水平位置，拉格朗日量是 $L(t; x, y; v_x, v_y) = \frac{1}{2} m (v_x^2 + v_y^2) - mgy$。我们有：⁶²

```scheme
(define ((L-uniform-acceleration m g) local)
  (let ((q (coordinate local))
        (v (velocity local)))
    (let ((y (ref q 1)))
      (- (* 1/2 m (square v)) (* m g y)))))

(show-expression
 (((Lagrange-equations
    (L-uniform-acceleration ’m ’g))
   (up (literal-function ’x)
       (literal-function ’y)))
  ’t))
```

$$
\left[ \begin{array}{c} m D^2 x(t) \\ gm + m D^2 y(t) \end{array} \right]
$$
这个方程组描述了水平方向上的无加速度运动（$m D^2 x(t) = 0$）和竖直方向上的匀加速运动（$m D^2 y(t) = -gm$）。

-----

#### **示例：中心力场 (Central force field)**

考虑一个质量为 $m$ 的粒子在中心力场中的平面运动，其势能为 $U(r)$，仅依赖于到引力中心的距离 $r$。我们将分别在直角坐标系和极坐标系中推导该系统的拉格朗日方程。

**直角坐标系**
在以引力中心为原点的直角坐标系 $(x, y)$ 中，势能为 $V(t; x, y) = U(\sqrt{x^2 + y^2})$，动能为 $T(t; x, y; v_x, v_y) = \frac{1}{2} m (v_x^2 + v_y^2)$。系统的一个拉格朗日量是 $L = T - V$：

$$
L(t; x, y; v_x, v_y) = \frac{1}{2} m (v_x^2 + v_y^2) - U(\sqrt{x^2 + y^2}).
\tag{1.61}
$$
作为程序：

```scheme
(define ((L-central-rectangular m U) local)
  (let ((q (coordinate local))
        (v (velocity local)))
    (- (* 1/2 m (square v))
       (U (sqrt (square q))))))
```

拉格朗日方程为：

```scheme
(show-expression
 (((Lagrange-equations
    (L-central-rectangular ’m (literal-function ’U)))
   (up (literal-function ’x)
       (literal-function ’y)))
  ’t))
```

$$
\left[ \begin{array}{c} m D^2 x(t) + \frac{DU(\sqrt{(y(t))^2 + (x(t))^2}) x(t)}{\sqrt{(y(t))^2 + (x(t))^2}} \\ m D^2 y(t) + \frac{DU(\sqrt{(x(t))^2 + (y(t))^2}) y(t)}{\sqrt{(x(t))^2 + (y(t))^2}} \end{array} \right]
$$
我们可以将这些拉格朗日方程重写为：

$$
m D^2 x(t) = -\frac{x(t)}{r(t)} DU(r(t))
\tag{1.62}
$$
$$
m D^2 y(t) = -\frac{y(t)}{r(t)} DU(r(t)),
\tag{1.63}
$$
其中 $r(t) = \sqrt{(x(t))^2 + (y(t))^2}$。我们可以这样解释：粒子受到一个大小为 $-DU(r)$、沿径向的力。牛顿方程使该力等于质量与加速度的乘积。这两个拉格朗日方程正是牛顿方程的直角坐标分量。

**极坐标系**
我们可以用极坐标来描述同一个系统。直角坐标 $(x, y)$ 和极坐标 $(r, \phi)$ 之间的关系是：

$$
x = r \cos \phi \quad y = r \sin \phi.
\tag{1.64}
$$
广义速度之间的关系由坐标变换推导得出。考虑一条在直角坐标系和极坐标系中均有表示的位形路径。设 $\tilde{x}$ 和 $\tilde{y}$ 是直角坐标路径的分量，$\tilde{r}$ 和 $\tilde{\phi}$ 是相应极坐标路径的分量。在时刻 $t$ 的直角坐标分量是 $(\tilde{x}(t), \tilde{y}(t))$，极坐标是 $(\tilde{r}(t), \tilde{\phi}(t))$。它们通过 (1.64) 相关联：

$$
\tilde{x}(t) = \tilde{r}(t) \cos \tilde{\phi}(t) \quad \tilde{y}(t) = \tilde{r}(t) \sin \tilde{\phi}(t).
\tag{1.65}
$$
时刻 $t$ 的直角坐标速度是 $(D\tilde{x}(t), D\tilde{y}(t))$。对 (1.65) 求导，给出速度之间的关系：

$$
D\tilde{x}(t) = D\tilde{r}(t) \cos \tilde{\phi}(t) - \tilde{r}(t) D\tilde{\phi}(t) \sin \tilde{\phi}(t)
\tag{1.66}
$$
$$
D\tilde{y}(t) = D\tilde{r}(t) \sin \tilde{\phi}(t) + \tilde{r}(t) D\tilde{\phi}(t) \cos \tilde{\phi}(t).
\tag{1.67}
$$
这些关系在任何时刻对任何位形路径都有效，因此我们可以将它们抽象为任意速度的坐标表示之间的关系。设 $v_x$ 和 $v_y$ 为速度的直角坐标分量，$\dot{r}$ 和 $\dot{\phi}$ 为 $r$ 和 $\phi$ 的变化率。那么：

$$
v_x = \dot{r} \cos \phi - r \dot{\phi} \sin \phi \quad v_y = \dot{r} \sin \phi + r \dot{\phi} \cos \phi.
$$
动能是 $\frac{1}{2} m (v_x^2 + v_y^2)$：

$$
T(t; r, \phi; \dot{r}, \dot{\phi}) = \frac{1}{2} m (\dot{r}^2 + r^2 \dot{\phi}^2),
\tag{1.68}
$$
拉格朗日量为：

$$
L(t; r, \phi; \dot{r}, \dot{\phi}) = \frac{1}{2} m (\dot{r}^2 + r^2 \dot{\phi}^2) - U(r).
\tag{1.69}
$$
我们将这个拉格朗日量表示如下：

```scheme
(define ((L-central-polar m U) local)
  (let ((q (coordinate local))
        (qdot (velocity local)))
    (let ((r (ref q 0)) (phi (ref q 1))
          (rdot (ref qdot 0)) (phidot (ref qdot 1)))
      (- (* 1/2 m
            (+ (square rdot)
               (square (* r phidot))) )
         (U r)))))
```

拉格朗日方程是：

```scheme
(show-expression
 (((Lagrange-equations
    (L-central-polar ’m (literal-function ’U)))
   (up (literal-function ’r)
       (literal-function ’phi)))
  ’t))
```

$$
\left[ \begin{array}{c} m D^2 r(t) - m r(t) (D\phi(t))^2 + DU(r(t)) \\ 2 m Dr(t) r(t) D\phi(t) + m D^2 \phi(t) (r(t))^2 \end{array} \right]
$$
我们可以将第一个方程解释为：质量与径向加速度的乘积，等于势能力与**离心力 (centrifugal force)** 之和。第二个方程可以解释为：**角动量 (angular momentum)** $m r^2 D\phi$ 的导数为零，因此角动量守恒。

注意，我们在两种坐标系中都使用了**相同**的 `Lagrange-equations` 程序。拉格朗日量的坐标表示在不同坐标系中是不同的，拉格朗日方程在不同坐标系中看起来也不同。然而，在任何坐标系中，推导拉格朗日方程所用的方法都是相同的。

-----

## **练习 1.14：拉格朗日方程的坐标无关性**

检验中心力运动在极坐标系和直角坐标系中的拉格朗日方程是等价的。通过将路径代入变换方程并计算导数来确定二阶导数之间的关系，然后将这些关系代入运动方程。

### **1.6.1 坐标变换 (Coordinate Transformations)**

系统的运动独立于我们用来描述它的坐标。运动的这种**坐标无关性 (coordinate-free nature)** 在作用量原理中是显而易见的。作用量只取决于拉格朗日量沿路径的值，而与拉格朗日量表示中所用的特定坐标无关。我们可以利用这个性质，从一个坐标系中的拉格朗日量来找出另一个坐标系中的拉格朗日量。

假设我们有一个力学系统，其运动由拉格朗日量 $L$ 描述， $L$ 依赖于时间、坐标和速度。又假设我们有一个坐标变换 $F$，使得 $x = F(t, x')$。拉格朗日量 $L$ 是用不带撇的坐标表示的。我们想找到一个用带撇坐标表示的拉格朗日量 $L'$，它描述的是同一个系统。

一种方法是要求拉格朗日量沿**任何**位形路径的值都独立于坐标系。如果 $q$ 是不带撇坐标系中的一条路径，$q'$ 是带撇坐标系中相应的路径，那么拉格朗日量必须满足：

$$
L' \circ \Gamma[q'] = L \circ \Gamma[q].
\tag{1.70}
$$
我们已经看到，从直角坐标到极坐标的变换，意味着广义速度也以某种特定的方式变换。速度变换可以从“极坐标中的路径”和“相应的直角坐标中的路径”必须与坐标变换保持一致这一要求中推导出来。

更一般地，要求两条不同坐标系中的路径与坐标变换保持一致，可以用来推导局域元组的所有分量是如何变换的。给定一个坐标变换 $F$，设 $C$ 是相应的函数，它将带撇坐标系中的局域元组映射到不带撇坐标系中相应的局域元组：

$$
C \circ \Gamma[q'] = \Gamma[q].
\tag{1.71}
$$
我们将在下面推导 $C$ 的一般形式。

给定这样一个局域元组变换 $C$，一个满足方程 (1.70) 的拉格朗日量 $L'$ 是：

$$
L' = L \circ C.
\tag{1.72}
$$
我们可以通过将 $L'$ 代入方程 (1.70) 来验证这一点：

$$
L' \circ \Gamma[q'] = (L \circ C) \circ \Gamma[q'] = L \circ (C \circ \Gamma[q']) = L \circ \Gamma[q].
\tag{1.73}
$$
为了在给定坐标变换 $F$ 的情况下找到局域元组变换 $C$，我们来推导局域元组的每个分量是如何变换的。坐标变换指定了局域元组的坐标分量如何变换：

$$
x = F(t, x').
\tag{1.74}
$$
局域元组变换的广义速度分量可以如下推导。设 $q$ 和 $q'$ 是同一条位形路径在两个坐标系中的表示。将这些路径代入坐标变换 (1.74) 并计算导数，我们发现：

$$
Dq(t) = \partial_0 F(t, q'(t)) + \partial_1 F(t, q'(t)) Dq'(t).
\tag{1.75}
$$
（因为）穿过任意一点总能存在一条具有任意给定速度的路径，所以我们可以推广并得出结论：沿着相应的坐标路径，广义速度满足：

$$
v = \partial_0 F(t, x') + \partial_1 F(t, x') v'.
\tag{1.76}
$$
如果需要，局域元组的更高阶导数分量的变换法则也可以用类似的方式确定。将局域元组从带撇系统变换到不带撇系统的局域元组变换 $C$，是由各分量变换构建的：

$$
C(t, x', v') = (t, F(t, x'), \partial_0 F(t, x') + \partial_1 F(t, x') v').
\tag{1.77}
$$
因此，如果我们取拉格朗日量 $L'$ 为：

$$
L' = L \circ C,
\tag{1.78}
$$
那么作用量的值就与计算它所用的坐标系无关。使作用量平稳的位形路径不依赖于用来描述该路径的坐标系。从这些拉格朗日量推导出的拉格朗日方程通常看起来会彼此大不相同，但它们必须是等价的。

-----

## **练习 1.15：等价性**

通过直接计算表明，如果 $L$ 的拉格朗日方程被满足，那么 $L'$ 的拉格朗日方程也会被满足。

给定一个坐标变换 $F$，我们可以使用 (1.77) 来找到变换局域元组的函数 $C$。程序 `F->C` 实现了这一点：⁶³

```scheme
(define ((F->C F) local)
  (up (time local)
      (F local)
      (+ (((partial 0) F) local)
         (* (((partial 1) F) local)
            (velocity local)))))
```

作为说明，考虑从极坐标到直角坐标的变换，$x = r \cos \phi$ 和 $y = r \sin \phi$，其实现如下：

```scheme
(define (p->r local)
  (let ((polar-tuple (coordinate local)))
    (let ((r (ref polar-tuple 0))
          (phi (ref polar-tuple 1)))
      (let ((x (* r (cos phi)))
            (y (* r (sin phi))))
        (up x y)))))
```

用极坐标和极坐标的变化率来表示，直角坐标分量的变化率是：⁶⁴

```scheme
(show-expression
 (velocity
  ((F->C p->r)
   (up ’t (up ’r ’phi) (up ’rdot ’phidot)))))
```

$$
\left( \begin{array}{c} -\dot{\phi} r \sin(\phi) + \dot{r} \cos(\phi) \\ \dot{\phi} r \cos(\phi) + \dot{r} \sin(\phi) \end{array} \right)
$$
我们可以使用 `F->C`，通过方程 (1.72)，从直角坐标分量中的拉格朗日量来找到极坐标中中心力运动的拉格朗日量：

```scheme
(define (L-central-polar m U)
(compose (L-central-rectangular m U) (F->C p->r)))

(show-expression
((L-central-polar ’m (literal-function ’U))
(up ’t (up ’r ’phi) (up ’rdot ’phidot))))
```

$$
\frac{1}{2} m \dot{\phi}^2 r^2 + \frac{1}{2} m \dot{r}^2 - U(r)
$$
这个结果与拉格朗日量 (1.69) 相同。

-----

## **练习 1.16：中心力运动**

找出三维中心力运动在直角坐标系和球坐标系中的拉格朗日量。首先，解析地找出拉格朗日量，然后通过推广我们已经给出的程序，用计算机检查结果。

#### **科里奥利力与离心力 (Coriolis and centrifugal forces)**

一个自由粒子在旋转坐标系中的运动方程会有附加项。考虑一个在二维空间中运动的自由粒子。其拉格朗日量为：

```scheme
(define ((L-free-rectangular m) local)
  (let ((vx (ref (velocities local) 0))
        (vy (ref (velocities local) 1)))
    (* 1/2 m (+ (square vx) (square vy)))))
```

旋转在极坐标中很容易描述，所以我们变换到极坐标：

```scheme
(define (L-free-polar m)
  (compose (L-free-rectangular m) (F->C p->r)))
```

现在我们可以做一个简单的含时变换，变换到一个旋转坐标系，其旋转速率为 $\Omega$：

```scheme
(define ((F Omega) local)
  (let ((t (time local))
        (r (ref (coordinates local) 0))
        (theta (ref (coordinates local) 1)))
    (up r (+ theta (* Omega t)))))

(define (L-rotating-polar m Omega)
  (compose (L-free-polar m) (F->C (F Omega))))
```

现在让我们变换回直角坐标系：

```scheme
(define (L-rotating-rectangular m Omega)
  (compose (L-rotating-polar m Omega) (F->C r->p)))
```

在旋转直角坐标系中，新的拉格朗日量是：

```scheme
((L-rotating-rectangular ’m ’Omega)
 (up ’t (up ’x_r ’y_r) (up ’xdot_r ’ydot_r)))
(+ (* 1/2 (expt Omega 2) m (expt x_r 2))
   (* 1/2 (expt Omega 2) m (expt y_r 2))
   (* -1 Omega m xdot_r y_r)
   (* Omega m ydot_r x_r)
   (* 1/2 m (expt xdot_r 2))
   (* 1/2 m (expt ydot_r 2)))
```

尽管坐标变换是含时的，但得到的拉格朗日量却不显含时间。

自由粒子在旋转坐标系中的拉格朗日方程中，出现了包含角速度 $\Omega$ 的“力”项：

```scheme
(((Lagrange-equations (L-rotating-rectangular ’m ’Omega))
  (up (literal-function ’x_r) (literal-function ’y_r)))
 ’t)
(down
 (+ (* -1 (expt Omega 2) m (x_r t))
    (* -2 Omega m ((D y_r) t))
    (* m (((expt D 2) x_r) t)))
 (+ (* -1 (expt Omega 2) m (y_r t))
    (* 2 Omega m ((D x_r) t))
    (* m (((expt D 2) y_r) t))))
```

$$
\left( \begin{array}{c} - \Omega^2 m x_r(t) - 2 \Omega m D y_r(t) + m D^2 x_r(t) \\ - \Omega^2 m y_r(t) + 2 \Omega m D x_r(t) + m D^2 y_r(t) \end{array} \right)
$$
与 $\Omega^2$ 成正比的项被称为**离心力 (centrifugal force)** 项，与 $\Omega$ 成正比的项被称为**科里奥利力 (Coriolis force)** 项。注意，离心力项是径向的，指向远离旋转中心。这些附加的力项是从拉格朗日量中相应的项推导出来的。拉格朗日量中与 $\Omega^2$ 成正比的项可以被认为是**离心势能** (centrifugal potential energy) 的负值。

因为这是一个自由粒子，它在原始非旋转坐标系中的速度是恒定的。在旋转坐标系中，科里奥利项描述了一个垂直于速度的加速度，导致轨迹发生弯曲。

-----

### **1.6.2 具有刚性约束的系统 (Systems with Rigid Constraints)**

我们已经发现 $L = T - V$ 是一个适用于受到势能力作用的点粒子系统的拉格朗日量。扩展体有时可以方便地理想化为由**刚性约束 (rigid constraints)** 连接的点粒子系统。

我们将发现，$L = T - V$（用**无冗余坐标 (irredundant coordinates)** 表示）同样是一个合适的拉格朗日量，用于建模具有刚性约束的点粒子系统。我们将首先演示该方法，然后提供一个合理解释。

#### **刚性约束系统的拉格朗日量**

假设系统由 $N$ 个点质量构成，索引为 $\alpha$，处于普通的三维空间中。第一步是选择一套方便的、无冗余的广义坐标 $q$，并用它们来重新描述系统。用广义坐标表示，粒子 $\alpha$ 的直角坐标是：

$$
x_\alpha = f_\alpha (t, q).
\tag{1.79}
$$
对于无冗余坐标 $q$，所有的坐标约束都已内建于函数 $f_\alpha$ 中。我们通过将路径函数代入方程 (1.79)，求导，然后抽象到任意速度（见 1.6.1 节），来推导广义速度 $v$ 与组元粒子速度 $v_\alpha$ 之间的关系。我们发现：

$$
v_\alpha = \partial_0 f_\alpha (t, q) + \partial_1 f_\alpha (t, q) v.
\tag{1.80}
$$
我们使用方程 (1.79) 和 (1.80) 来用广义坐标和广义速度表示动能。设 $\tilde{T}$ 是作为直角坐标和速度的函数的动能：

$$
\tilde{T}(t; x_0, \dots, x_{N-1}; v_0, \dots, v_{N-1}) = \sum_\alpha \frac{1}{2} m_\alpha v_\alpha^2,
\tag{1.81}
$$
其中 $v_\alpha^2$ 是 $v_\alpha$ 的模的平方。作为广义坐标元组 $q$ 和广义速度元组 $v$ 的函数，动能是：

$$
T(t, q, v) = \tilde{T}(t; f_0(t, q), \dots; \partial_0 f_0(t, q) + \partial_1 f_0(t, q) v, \dots).
\tag{1.82}
$$
类似地，我们使用方程 (1.79) 来用广义坐标重新表示势能。设 $\tilde{V}(t, x)$ 是在时间 $t$、位形由直角坐标元组 $x$ 指定时的势能。用广义坐标表示，势能是：

$$
V(t, q, v) = \tilde{V}(t, f(t, q)).
\tag{1.83}
$$
我们取拉格朗日量为动能与势能之差：$L = T - V$。

-----

#### **示例：枢轴被驱动的摆 (A pendulum driven at the pivot)**

考虑一个摆（见图 1.2），长度为 $l$，质量为 $m$，被建模为一个点质量。它由一个枢轴支撑，该枢轴在竖直方向上由一个给定的时间函数 $y_s(t)$ 驱动。

*图 1.2 摆由枢轴的竖直运动驱动。枢轴在 y 轴上滑动。虽然摆锤被画成一团，但它被建模为一个点质量。摆锤受到沿 $\hat{y}$ 负方向的均匀重力加速度 $g$ 的作用。*

该系统的位形空间维度是一；我们选择图 1.2 中所示的 $\theta$ 作为广义坐标。

摆锤的位置（用直角坐标表示）为：

$$
x = l \sin \theta \quad y = y_s(t) - l \cos \theta.
\tag{1.84}
$$
速度为：

$$
v_x = l \dot{\theta} \cos \theta \quad v_y = D y_s(t) + l \dot{\theta} \sin \theta,
\tag{1.85}
$$
这是通过沿路径求导并抽象到该时刻的速度得到的。

动能为 $\tilde{T}(t; x, y; v_x, v_y) = \frac{1}{2} m (v_x^2 + v_y^2)$。用广义坐标表示，动能是：

$$
T(t, \theta, \dot{\theta}) = \frac{1}{2} m (l^2 \dot{\theta}^2 + (D y_s(t))^2 + 2 l D y_s(t) \dot{\theta} \sin \theta).
\tag{1.86}
$$
势能为 $\tilde{V}(t; x, y) = mgy$。用广义坐标表示，势能是：

$$
V(t, \theta, \dot{\theta}) = g m (y_s(t) - l \cos \theta).
\tag{1.87}
$$
一个拉格朗日量是 $L = T - V$：

$$
L(t, \theta, \dot{\theta}) = \frac{1}{2} m (l^2 \dot{\theta}^2 + (D y_s(t))^2 + 2 l D y_s(t) \dot{\theta} \sin \theta) - g m (y_s(t) - l \cos \theta).
\tag{1.88}
$$
该拉格朗日量表示为：

```scheme
(define ((T-pend m l g ys) local)
(let ((t (time local))
(theta (coordinate local))
(thetadot (velocity local)))
(let ((vys (D ys)))
(* 1/2 m
(+ (square (* l thetadot))
(square (vys t))
(* 2 l (vys t) thetadot (sin theta)))))))

(define ((V-pend m l g ys) local)
(let ((t (time local))
(theta (coordinate local)))
(* m g (- (ys t) (* l (cos theta))))))

(define L-pend (- T-pend V-pend))
```

该系统的拉格朗日方程为：

```scheme
(show-expression
(((Lagrange-equations
(L-pend ’m ’l ’g (literal-function ’y_s)))
(literal-function ’theta))
’t))
```

$$
D^2 \theta(t) l^2 m + D^2 y_s(t) \sin(\theta(t)) l m + \sin(\theta(t)) g l m

$$

-----

**练习 1.17：螺旋线上的珠子**
一个质量为 $m$ 的珠子被约束在一条无摩擦的螺旋线上运动。螺旋线的轴线水平放置。螺旋线的直径为 $d$，螺距（每单位长度的圈数）为 $h$。系统处于一个竖直加速度为 $g$ 的匀强重力场中。构建一个描述该系统的拉格朗日量，并找出拉格朗日运动方程。

**练习 1.18：三轴椭球面上的珠子**
一个质量为 $m$ 的珠子在一个三轴椭球面上无摩擦地运动。在直角坐标系中，该表面满足：

$$
\frac{x^2}{a^2} + \frac{y^2}{b^2} + \frac{z^2}{c^2} = 1
\tag{1.89}
$$
对于某些常数 $a, b, c$。确定合适的广义坐标，构建一个拉格朗日量，并找出拉格朗日方程。

*图 1.3 一个两杆连杆被建模为由刚性无质量杆连接的三个点质量。该连杆受到一个均匀的竖直重力加速度作用。*

*图 1.4 这个摆的枢轴是一个质量为 $m_1$ 的点粒子，该粒子可以在水平导轨上滑动。摆锤是一个质量为 $m_2$ 的点粒子，受到竖直重力的作用。*

**练习 1.19：两杆连杆**
如图 1.3 所示的两杆连杆被约束在平面内运动。它由三个小质量物体通过两个无质量刚性杆连接而成，处于一个竖直加速度为 $g$ 的匀强重力场中。杆通过一个铰链固定在中心物体上，允许连杆折叠。系统的布置使得铰链是完全自由的：各部件可以在不发生碰撞的情况下经历所有位形。构建一个描述该系统的拉格朗R朗日量，并找出拉格朗日运动方程。请使用计算机来完成，因为方程相当庞大。

## **练习 1.20：滑动摆**

考虑一个长度为 $l$ 的摆，其支撑点可以水平移动，如图 1.4 所示。设支撑点的质量为 $m_1$，摆锤的质量为 $m_2$。构建一个拉格朗日量，并推导该系统的拉格朗日方程。

#### **为什么 $L=T-V$ 可行？ (Why it works)**

在本节中，我们证明 $L = T - V$ 确实是刚性约束系统的一个合适的拉格朗日量。我们通过要求拉格朗日方程等价于包含矢量约束力的牛顿矢量动力学来实现这一点。⁶⁵

我们考虑一个粒子系统。索引为 $\alpha$ 的粒子质量为 $m_\alpha$，在时间 $t$ 的位置为 $\vec{x}_\alpha(t)$。这些粒子的数量可能非常多，也可能只有几个。其中一些位置也可能是时间的指定函数，例如被驱动摆的枢轴位置。

在某些粒子之间存在刚性位置约束。我们假设所有这些约束的形式都是：

$$
(\vec{x}_\alpha(t) - \vec{x}_\beta(t)) \cdot (\vec{x}_\alpha(t) - \vec{x}_\beta(t)) = l_{\alpha\beta}^2;
\tag{1.90}
$$
也就是说，粒子 $\alpha$ 和 $\beta$ 之间的距离是 $l_{\alpha\beta}$。

粒子 $\alpha$ 的牛顿运动方程表明，粒子 $\alpha$ 的质量乘以其加速度等于势能力和约束力之和。势能力是势能的负梯度，可能依赖于其他粒子的位置和时间。约束力 $\vec{F}_{\alpha\beta}$ 是与粒子 $\alpha$ 和 $\beta$ 之间刚性约束相关的矢量约束力。所以：

$$
m_\alpha D^2 \vec{x}_\alpha(t) = -\vec{\nabla}*{\vec{x}_\alpha} \mathcal{V}(\dots) + \sum*{\beta \leftrightarrow \alpha} \vec{F}\_{\alpha\beta}(t),
\tag{1.91}
$$
在求和中，$\beta$ 只遍历那些与粒子 $\alpha$ 存在刚性约束的粒子索引；我们使用记号 $\beta \leftrightarrow \alpha$ 来表示它们之间存在刚性约束。

约束力沿着粒子之间的连线方向，所以我们可以写：

$$
\vec{F}_{\alpha\beta}(t) = F_{\alpha\beta}(t) \frac{\vec{x}_\beta(t) - \vec{x}_\alpha(t)}{l_{\alpha\beta}},
\tag{1.92}
$$
其中 $F_{\alpha\beta}(t)$ 是在时间 $t$ 约束中的标量张力大小。注意 $\vec{F}_{\alpha\beta} = -\vec{F}_{\beta\alpha}$。通常，标量约束力会随着系统的演化而改变。

形式上，我们可以用下面的拉格朗日量来重现牛顿方程：⁶⁶

$$
L(t, x, \dot{x}, F, \dot{F}) = \sum_\alpha \frac{1}{2} m_\alpha \dot{x}*\alpha^2 - \tilde{V}(t, x) + \sum*{\alpha, \beta \leftrightarrow \alpha} \frac{1}{2} F_{\alpha\beta} ((x_\beta - x_\alpha)^2 - l_{\alpha\beta}^2),
\tag{1.93}
$$
这里的约束力 $F$ 被当作附加的广义坐标。这里 $x$ 是一个由所有 $\vec{x}_\alpha$ 的所有直角坐标分量 $x_\alpha$ 组成的结构，$\dot{x}$ 是一个由所有速度矢量 $\vec{v}_\alpha$ 的所有直角坐标分量 $\dot{x}_\alpha$ 组成的结构，$F$ 是一个由所有 $F_{\alpha\beta}$ 组成的结构。$F$ 的速度没有出现在拉格朗日量中，而 $F$ 本身仅以线性形式出现。所以与 $F$ 相关的拉格朗日方程是：

$$
(x_\beta(t) - x_\alpha(t))^2 - l_{\alpha\beta}^2 = 0,
\tag{1.94}
$$
但这只是对约束的重述。与粒子坐标相关的拉格朗日方程正是牛顿方程 (1.91)：

$$
D(m_\alpha D x_\alpha)(t) = -\partial_{1,\alpha} \tilde{V}(t, x(t)) + \sum_{\beta \leftrightarrow \alpha} F_{\alpha\beta}(t) \frac{x_\beta(t) - x_\alpha(t)}{l_{\alpha\beta}}.
\tag{1.95}
$$
现在我们有了一个合适的拉格朗日量，我们可以利用拉格朗日量可以用任何广义坐标重新表达这一事实，来找到一个更简单的拉格朗日量。策略是选择一套新的坐标，其中许多坐标是常量，而其余的坐标是无冗余的。

设 $q$ 是一个广义坐标元组，它无冗余地指定了系统的自由度。设 $c$ 是另一个广义坐标元组，它指定了那些被约束的粒子之间的距离。$c$ 坐标将具有恒定的值。$q$ 和 $c$ 的组合取代了冗余的直角坐标 $x$。⁶⁷ 此外，我们仍有 $F$ 坐标，它们是标量约束力。我们的新坐标是 $q, c, F$ 的分量。

存在函数 $f_\alpha$，它们用 $q$ 和 $c$ 给出组元粒子的直角坐标：

$$
x_\alpha = f_\alpha (t, q, c).
\tag{1.96}
$$
为了用 $q, c, F$ 重新表示拉格朗日量，我们需要找到 $v_\alpha$（$x_\alpha$ 的速度）与广义速度 $\dot{q}, \dot{c}$ 的关系：我们通过沿路径对 $f_\alpha$ 求导并抽象到任意速度来做到这一点（见 1.6.1 节）：

$$
v_\alpha = \partial_0 f_\alpha (t, q, c) + \partial_1 f_\alpha (t, q, c) \dot{q} + \partial_2 f_\alpha (t, q, c) \dot{c}.
\tag{1.97}
$$
将这些代入拉格朗日量 (1.93)，并使用

$$
c_{\alpha\beta}^2 = (x_\beta - x_\alpha)^2,
\tag{1.98}
$$
我们发现：

$$
L(t, q, c, F; \dot{q}, \dot{c}, \dot{F}) = \sum_\alpha \frac{1}{2} m_\alpha v_\alpha^2 - \tilde{V}(t, f(t, q, c)) + \sum_{\alpha, \beta \leftrightarrow \alpha} \frac{1}{2} F_{\alpha\beta} (c_{\alpha\beta}^2 - l_{\alpha\beta}^2).
\tag{1.99}
$$
拉格朗日方程由通常的程序推导得出。我们不去写下所有繁琐的细节，而是思考一下它将如何进行。

与 $F$ 相关的拉格朗日方程只是重述了约束条件：

$$
0 = c_{\alpha\beta}(t)^2 - l_{\alpha\beta}^2,
\tag{1.100}
$$
因此我们知道，沿着一条解路径，$c(t) = l$ 且 $Dc(t) = D^2 c(t) = 0$。我们可以用这个结果来简化与 $q$ 和 $c$ 相关的拉格朗日方程。

与 $q$ 相关的拉格朗日方程，与从下面这个拉格朗日量⁶⁸ 推导出的方程是相同的：

$$
L(t, q, c; \dot{q}, \dot{c}) = \sum_\alpha \frac{1}{2} m_\alpha v_\alpha^2 - \tilde{V}(t, f(t, q, c)),
\tag{1.101}
$$
但这**正是 $T - V$**，其中 $T$ 和 $V$ 是用广义坐标 $q$ 和固定的约束 $c$ 计算的。注意，约束力 $F$ 没有出现在 $q$ 的拉格朗日方程中，因为在拉格朗日方程中，它们乘以了一个在解路径上恒等于零的项。

因此，对于 $T - V$（使用无冗余的广义坐标 $q$ 和固定约束 $c$），其拉格朗日方程等价于带有矢量约束力的牛顿方程。

$c$ 的拉格朗日方程可以用来求解约束力。这些方程非常庞杂，所以我们不显式地展示它们，但总的来说，它们是关于 $D^2 c, Dc, c$ 的方程，并将依赖于 $q, Dq, F$。对 $F$ 的依赖是线性的，所以我们可以用解路径 $q, Dq$ 以及 $c = l, Dc = D^2 c = 0$ 来求解 $F$。

如果我们对约束力不感兴趣，我们可以放弃完整的拉格朗日量 (1.99)，转而使用拉格朗日量 (1.101)，就广义坐标 $q$ 的演化而言，它是等价的。

*图 1.5 一根长度为 $l$ 的刚性杆约束着平面内的两个有质量粒子。*

即使粒子间距离约束中指定的长度 $l_{\alpha\beta}$ 是时间的函数，同样的推导也成立。通过使某些粒子 $\vec{x}_\beta$ 的位置成为时间的指定函数，它还可以推广到允许距离约束指向含时位置的情况。

-----

**练习 1.21：一个哑铃**
在本练习中，我们将为一个特定的简单系统概括约束系统拉格朗日量的推导过程。
考虑平面上的两个有质量的粒子，被一根无质量的刚性杆约束，保持距离 $l$ 不变，如图 1.5 所示。平面上的两个有质量粒子显然有四个自由度，但刚性杆将其减少到三个。
我们可以用粒子的冗余坐标来唯一指定位形，例如 $x_0(t), y_0(t)$ 和 $x_1(t), y_1(t)$。约束 $(x_1(t) - x_0(t))^2 + (y_1(t) - y_0(t))^2 = l^2$ 消除了一个自由度。
a. 给定杆中的标量张力为 $F$，为两个粒子的四个直角坐标写出牛顿力平衡方程。
b. 写出形式拉格朗日量 $L(t; x_0, y_0, x_1, y_1, F; \dot{x}_0, \dot{y}_0, \dot{x}_1, \dot{y}_1, \dot{F})$，使其拉格朗日方程能产生你在 a 部分推导出的牛顿方程。
c. 进行坐标变换，变换到一个使用质心坐标 $x_{CM}, y_{CM}$、角度 $\theta$、粒子间距 $c$ 和张力 $F$ 的坐标系。用这些坐标写出拉格朗日量，并写出拉格朗日方程。
d. 你可以从这些方程中的一个推断出 $c(t) = l$。由此我们得到 $Dc = 0$ 和 $D^2 c = 0$。将这些代入你刚计算出的拉格朗日方程，以获得 $x_{CM}, y_{CM}, \theta$ 的运动方程。
e. 为这个用无冗余广义坐标 $x_{CM}, y_{CM}, \theta$ 描述的系统构建一个拉格朗日量（$= T - V$），并从此拉格朗日量计算拉格朗日方程。它们应该与你在 d 部分为相同坐标推导出的方程相同。

**练习 1.22：被驱动的摆**
证明拉格朗日量 (1.93) 可用于描述被驱动的摆（1.6.2 节），其中枢轴的位置是时间的指定函数：使用牛顿约束力规范推导运动方程，并证明它们与拉格朗日方程相同。请务必检查约束力的方程以及摆锤位置的方程。

**练习 1.23：填补细节**
证明拉格朗日量 (1.101) 的拉格朗日方程与拉格朗日量 (1.99) 在代入 $c(t) = l, Dc(t) = 0, D^2 c(t) = 0$ 后的拉格朗日方程相同。

## **练习 1.24：约束力**

找出未被驱动的平面摆中的张力。

### **1.6.3 作为坐标变换的约束 (Constraints as Coordinate Transformations)**

为约束系统推导拉格朗日量的步骤，与推导坐标变换的步骤是类似的。

我们可以为直角坐标系中的无约束粒子系统建立一个拉格朗日量。通常，坐标的数量会多于实际的自由度；约束将消除这种冗余。然后我们选择一套方便的、包含约束的无冗余广义坐标来描述我们的系统。我们用无冗余的广义坐标和广义速度来表示冗余的直角坐标和速度，然后我们使用这些变换来用广义坐标重新表示拉格朗日量。

为了执行坐标变换，我们指定了如何将一个用某套广义坐标表示的系统位形，用另一套广义坐标来重新表示。然后我们确定由广义坐标变换所隐含的广义速度变换。一个用某套广义坐标表示的拉格朗日量，随后就可以用另一套广义坐标来重新表示。

这实际上是同一过程的两种应用，因此我们可以通过将无约束粒子的拉格朗日量与一个包含了约束的坐标变换进行**复合**，来构建约束系统的拉格朗日量。事实上，我们推导出的 $L = T - V$ 适用于约束系统，正是基于一个坐标变换——从一个受约束的坐标集变换到一个无冗余坐标集，外加值为常数的约束坐标集。

设 $x_\alpha$ 是组元粒子 $\alpha$ 的直角坐标分量元组， $v_\alpha$ 是其速度。拉格朗日量

$$
L_f = \sum_\alpha \left( \frac{1}{2} m_\alpha v_\alpha^2 \right) - V(t, x)
\tag{1.102}
$$
是组元粒子的动能与势能之差。这是一个适用于具有势能 $V$ 的无约束自由粒子集的拉格朗日量。

设 $q$ 是一个无冗余广义坐标的元组，$v$ 是相应的广义速度元组。如前所述，坐标 $q$ 通过 $x_\alpha = f_\alpha(t, q)$ 与组元粒子的坐标 $x_\alpha$ 相关联。组元粒子之间的约束在 $f_\alpha$ 的定义中被考虑了。在这里，我们将其视为一个坐标变换。这种坐标变换的特别之处在于 $x$ 的维数与 $q$ 的维数不同。

从这个坐标变换中，我们可以找到局域元组的变换函数（见 1.6.1 节）：

$$
(t; x_0, \dots, x_{N-1}; v_0, \dots, v_{N-1}) = C(t, q, v).
\tag{1.103}
$$
约束系统的拉格朗日量，可以通过将无约束系统的拉格朗日量与这个局域元组变换函数（从约束坐标到无约束坐标）进行复合来获得：

$$
L = L_f \circ C.
\tag{1.104}
$$
约束仅仅在变换中才进入。

为了说明这一点，我们将找出 1.6.2 节中引入的被驱动摆的拉格朗日量。正如我们在第40页看到的，对于一个质量为 $m$、在加速度为 $g$ 的引力势作用下、在竖直平面内运动的自由粒子，$T - V$ 拉格朗日量是：

$$
L_f(t; x, y; v_x, v_y) = \frac{1}{2} m (v_x^2 + v_y^2) - mgy,
\tag{1.105}
$$
其中 $y$ 测量点质量的高度。一个计算该拉格朗日量的程序是：

```scheme
(define ((L-uniform-acceleration m g) local)
  (let ((q (coordinate local))
        (v (velocity local)))
    (let ((y (ref q 1)))
      (- (* 1/2 m (square v)) (* m g y)))))
```

从广义坐标 $\theta$ 到直角坐标的坐标变换是 $x = l \sin \theta, y = y_s(t) - l \cos \theta$，其中 $l$ 是摆的长度，$y_s$ 给出支撑点高度随时间变化的函数。有趣的是，驱动仅仅通过约束的规范进入。实现这一坐标变换的程序是：

```scheme
(define ((dp-coordinates l y_s) local)
  (let ((t (time local))
        (theta (coordinate local)))
    (let ((x (* l (sin theta)))
          (y (- (y_s t) (* l (cos theta)))))
      (up x y))))
```

使用 `F->C`，我们可以推导出局域元组变换，并通过复合来定义被驱动摆的拉格朗日量：

```scheme
(define (L-pend m l g y_s)
  (compose (L-uniform-acceleration m g)
           (F->C (dp-coordinates l y_s))))
```

这个拉格朗日量是：

```scheme
(show-expression
 ((L-pend ’m ’l ’g (literal-function ’y_s))
  (up ’t ’theta ’thetadot)))
```

$$
g l m \cos(\theta) - g m y_s(t) + \frac{1}{2} l^2 m \dot{\theta}^2 + l m \dot{\theta} D y_s(t) \sin(\theta) + \frac{1}{2} m (D y_s(t))^2
$$
这与第51页的方程 (1.88) 中的拉格朗日量相同。

我们为约束系统的拉格朗日量找到了一个非常有趣的分解。一部分由组元粒子的动能和势能之差组成。另一部分描述了特定系统位形所特有的约束。

-----

**练习 1.25：傅科摆 (Foucault pendulum) 拉格朗日量**
傅科摆是一个长周期摆，长度为 $l$，质量为 $m$，悬挂在地球（半径为 $R$）表面上方 $l$ 处，其**余纬** (colatitude) 为 $\phi$。如果摆从偏离当地竖直方向的非零位移处静止释放，它将在一个视平面 (apparent plane) 内振荡。然而，随着地球的自转，这个振荡的视平面会发生进动。地球以角速度 $\Omega$ 自转。

一种指定摆锤位置的方法是，在北极架设一个傅科摆，然后将其旋转到地球表面上具有适当余纬和固定经度的某一点。由于地球在自转，这是一个含时变换。这个变换有两部分。

首先，我们将广义坐标 $\theta$ 和 $\lambda$ 与摆在北极时摆锤的坐标联系起来。设 $\theta$ 是摆锤相对于穿过地心连线的角度，$\lambda$ 是进动角。摆在北极时，摆锤的直角坐标是：

$$
\begin{aligned}
x_0 &= l \sin \theta \cos \lambda \\
y_0 &= l \sin \theta \sin \lambda \\
z_0 &= (R + l) - l \cos \theta.
\end{aligned}
$$
接下来，我们将摆旋转到它在余纬 $\phi$ 处的实际位置。我们可以选择经度为零，所以摆锤支撑点的角位置旋转了 $\Omega t$。坐标变换为：⁶⁹

$$
(x, y, z) = R_z(\Omega t) R_y(\phi) (x_0, y_0, z_0).
$$
这第二个变换可以用以下代码实现：

```scheme
((compose (Rz (* ’Omega ’t)) (Ry ’phi))
(up ’x_0 ’y_0 ’z_0))
(up
(+ (* x_0 (cos phi) (cos (* Omega t)))
(* z_0 (sin phi) (cos (* Omega t)))
(* -1 y_0 (sin (* Omega t))))
(+ (* x_0 (cos phi) (sin (* Omega t)))
(* z_0 (sin phi) (sin (* Omega t)))
(* y_0 (cos (* Omega t))))
(+ (* -1 x_0 (sin phi)) (* z_0 (cos phi))))
```

利用这些部分，构建一个坐标变换 $F$，你可以将其与 `F->C` 一起使用，并与一个粒子在引力势中的自由拉格朗日量进行复合，以构建傅科摆的拉格朗日量。牛顿势能是 $-GMm/r$，其中 $r$ 是摆锤到地心的距离，$M$ 是地球的质量。

### **1.6.4 拉格朗日量不是唯一的 (The Lagrangian Is Not Unique)**

拉格朗日量与物理系统之间并非一一对应的关系——许多不同的拉格朗日量可以用来描述同一个物理系统。在本节中，我们将通过证明：在拉格朗日量上添加一个仅依赖于坐标和时间的函数的“**全时间导数 (total time derivative)**”，并不会改变平稳作用量的路径，也不会改变从作用量原理推导出的运动方程。

#### **全时间导数**

首先让我们解释一下“全时间导数”的含义。设 $F$ 是一个时间和坐标的函数。$F$ 在路径上、在时间 $t$ 的值为：

$$
(F \circ \Gamma[q])(t) = F(t, q(t)).
\tag{1.106}
$$
因此，根据链式法则：

$$
D(F \circ \Gamma[q])(t) = \partial_0 F(t, q(t)) + \partial_1 F(t, q(t)) Dq(t).
\tag{1.107}
$$
更形式化地， $F$ 沿路径 $q$ 的时间导数是：

$$
D(F \circ \Gamma[q]) = (DF \circ \Gamma[q]) D\Gamma[q].
\tag{1.108}
$$
因为 $F$ 只依赖于时间和坐标，我们有：

$$
DF \circ \Gamma[q] = [\partial_0 F \circ \Gamma[q], \partial_1 F \circ \Gamma[q]].
\tag{1.109}
$$
所以我们只需要 $D\Gamma[q]$ 的前两个分量：

$$
(D\Gamma[q])(t) = (1, Dq(t), D^2 q(t), \dots),
\tag{1.110}
$$
来构成乘积：

$$
D(F \circ \Gamma[q]) = (\partial_0 F \circ \Gamma[q]) + (\partial_1 F \circ \Gamma[q]) (\dot{Q} \circ \Gamma[q]),
\tag{1.111}
$$
其中 $\dot{Q} = I_2$ 是一个选择器函数 (selector function)：⁷⁰ $c = \dot{Q}(a, b, c)$，所以 $Dq = \dot{Q} \circ \Gamma[q]$。

函数

$$
D_t F = \partial_0 F + (\partial_1 F) \dot{Q}
\tag{1.112}
$$
被称为 $F$ 的**全时间导数**；它是一个三个参数（时间、广义坐标、广义速度）的函数。

一般地，一个局域元组函数 $F$ 的全时间导数 $D_t F$ 是这样一个函数：当它与一个局域元组路径复合时，其结果等于函数 $F$ 与同一局域元组路径复合后的时间导数：

$$
D_t F \circ \Gamma[q] = D(F \circ \Gamma[q]).
\tag{1.113}
$$
全时间导数 $D_t F$ 显式地由下式给出：

$$
D_t F = \sum_{i \\ge 0} \partial_i F \\cdot I_{i+1},
\tag{1.114}
$$
其中 $I_{i+1}$ 是（局域元组的）第 $i+1$ 个分量（例如 $I_1 = q, I_2 = v, \dots$），我们根据需要取尽可能多的项，直到穷尽 $F$ 的所有参数。

-----

## **练习 1.26： $D_t$ 的性质**

全时间导数 $D_t F$ 并不是函数 $F$ 的导数。然而，全时间导数与导数有许多共同的性质。证明 $D_t$ 对于局域元组函数 $F, G$，数字 $c$，以及一个定义域包含 $G$ 值域的函数 $H$，具有以下性质： a. $D_t(F + G) = D_t F + D_t G$ b. $D_t(cF) = c D_t F$ c. $D_t(FG) = F D_t G + (D_t F) G$ d. $D_t(H \circ G) = (DH \circ G) D_t G$

#### **在拉格朗日量上添加全时间导数**

考虑两个拉格朗日量 $L$ 和 $L'$，它们相差一个仅依赖于时间和坐标的函数 $F$ 的全时间导数：

$$
L' = L + D_t F.
\tag{1.115}
$$
相应的作用量积分为：

$$
S'[q](t_1, t_2) = \int_{t_1}^{t_2} (L + D_t F) \circ \Gamma[q] dt = S[q](t_1, t_2) + \int_{t_1}^{t_2} D(F \circ \Gamma[q]) dt.
\tag{1.116}
$$
变分原理指出，沿着一条可实现轨迹的作用量积分，相对于那些保持端点位形固定的轨迹变分，是平稳的。作用量积分 $S[q](t_1, t_2)$ 和 $S'[q](t_1, t_2)$ 相差一项：

$$
(F \circ \Gamma[q]) \Big|_{t_1}^{t_2} = F(t_2, q(t_2)) - F(t_1, q(t_1)),
\tag{1.117}
$$
该项**只依赖于端点处的坐标和时间**，而这些在变分中是不允许改变的。因此，如果 $S[q](t_1, t_2)$ 对某条路径是平稳的，那么 $S'[q](t_1, t_2)$ 也将是平稳的。所以任何一个拉格朗日量都可以用来区分可实现的路径。

在拉格朗日量上添加一个全时间导数，并不影响作用量对于给定路径是否平稳。因此，如果我们有两个拉格朗日量，它们相差一个全时间导数，那么相应的拉格朗日方程是等价的，即相同的路径会同时满足它们。

而且，由全时间导数引入作用量的附加项只出现在端点项中，因此**不影响**从作用量变分推导出的拉格朗日方程，所以**拉格朗日方程是相同的**。在拉格朗日量上添加一个全时间导数并不会改变拉格朗日方程。

-----

**练习 1.27：全时间导数的拉格朗日方程**
设 $F(t, q)$ 是一个只依赖于 $t$ 和 $q$ 的函数，其全时间导数为

$$
D_t F = \partial_0 F + (\partial_1 F) \dot{Q}.
\tag{1.118}
$$
\#\# 显式地证明 $D_t F$ 的拉格朗日方程恒等于零，因此，将 $D_t F$ 添加到拉格朗日量中不影响拉格朗日方程。

被驱动的摆提供了一个很好的例子来说明给拉格朗日量添加全时间导数。被驱动摆的运动方程（见 1.6.2 节）：

$$
m l^2 D^2 \theta(t) + m l (g + D^2 y_s(t)) \sin \theta(t) = 0,
\tag{1.119}
$$
有一个有趣且富有启发性的解释：它与未被驱动的摆的运动方程相同，只是重力加速度 $g$ 被枢轴的加速度 $D^2 y_s$ 所增强了。这种直观的解释在 1.6.2 节中作为动能和势能之差推导出的拉格朗日量 $L$ 中并不明显。

然而，我们可以写出另一个具有相同运动方程的拉格朗日量 $L'$，它和运动方程一样容易解释：

$$
L'(t, \theta, \dot{\theta}) = \frac{1}{2} m l^2 \dot{\theta}^2 + m l (g + D^2 y_s(t)) \cos \theta.
\tag{1.120}
$$
有了这个拉格朗日量，很明显，加速枢轴的效应是修正了重力加速度。但是请注意，它**不是**动能与势能之差。

让我们比较一下被驱动摆的这两个拉格朗日量。差值 $\Delta L = L - L'$ 是：

$$
\Delta L = \frac{1}{2} m (D y_s(t))^2 + 2 l m D y_s(t) \dot{\theta} \sin \theta - g m y_s(t) - m l D^2 y_s(t) \cos \theta.
\tag{1.121}
$$
$\Delta L$ 中那两个既不依赖于 $\theta$ 也不依赖于 $\dot{\theta}$ 的项，不影响运动方程。剩下的两项是函数 $F(t, \theta) = -m l D y_s(t) \cos \theta$ 的全时间导数，该函数不依赖于 $\dot{\theta}$。将这样的项添加到拉格朗日量中不会影响运动方程。

-----

#### **全时间导数的性质**

如果局域元组函数 $G$（参数为 $(t, q, v)$）是某个函数 $F$（参数为 $(t, q)$）的全时间导数，那么 $G$ 必须具有某些性质。

从方程 (1.112) 中，我们看到 $G$ 必须在广义速度上是**线性**的：

$$
G(t, q, v) = G_0(t, q) + G_1(t, q) v,
\tag{1.122}
$$
其中 $G_1$ 和 $G_0$ 都不依赖于广义速度（即 $\partial_2 G_1 = \partial_2 G_0 = 0$）。

如果 $G$ 是 $F$ 的全时间导数，那么 $G_1 = \partial_1 F$ 且 $G_0 = \partial_0 F$，所以：

$$
\partial_0 G_1 = \partial_0 (\partial_1 F) \quad \text{且} \quad \partial_1 G_0 = \partial_1 (\partial_0 F).
\tag{1.123}
$$
（可交换的）偏导数与求导顺序无关，所以 $\partial_0 \partial_1 F = \partial_1 \partial_0 F$。因此，如果 $G$ 是 $F$ 的全时间导数，那么：

$$
\partial_0 G_1 = \partial_1 G_0.
\tag{1.124}
$$
此外，$G_1 = \partial_1 F$，所以：

$$
\partial_1 G_1 = \partial_1 \partial_1 F.
\tag{1.125}
$$
如果自由度大于一，这些偏导数实际上是关于每个坐标的偏导数结构。关于两个不同坐标的偏导数必须与求导顺序无关。所以 $\partial_1 G_1$ 必须是**对称的** (symmetric)。

请注意，我们只证明了这些是 $G$ 成为全时间导数的**必要**条件，并未证明它们是充分条件。

-----

## **练习 1.28：识别全时间导数**

对于下列每个函数，要么证明它不是一个全时间导数，要么给出一个它可以从中导出的函数。

a. $G(t, x, v_x) = m v_x$

b. $G(t, x, v_x) = m v_x \cos t$

c. $G(t, x, v_x) = v_x \cos t - x \sin t$

d. $G(t, x, v_x) = v_x \cos t + x \sin t$

e. $G(t; x, y; v_x, v_y) = 2(x v_x + y v_y) \cos t - (x^2 + y^2) \sin t$

f. $G(t; x, y; v_x, v_y) = 2(x v_x + y v_y) \cos t - (x^2 + y^2) \sin t + y^3 v_x + x v_y$

#### **动能的伽利略不变性 (Galilean invariance of kinetic energy)**

我们已经将一组粒子（索引为 $\alpha$）的动能取为 $T = \sum_\alpha \frac{1}{2} m_\alpha v_\alpha^2$。这种形式是**伽利略不变的** (Galilean invariant)。

-----

**练习 1.29：动能的伽利略不变性**

a. 从自由粒子的拉格朗日量开始，它只是它们动能的总和：

$$
L(t, x, v) = \sum_\alpha \frac{1}{2} m_\alpha v_\alpha^2.
\tag{1.126}
$$
执行一个从旧坐标到新坐标的坐标变换，该变换包含一次平移和一次匀速运动：

$$
x_\alpha = x'_\alpha + \Delta x + \Delta v t.
\tag{1.127}
$$
推导新坐标下的拉格朗日量。

b. 新的拉格朗日量可以写成 $\sum_\alpha \frac{1}{2} m_\alpha (v'_\alpha)^2$ 加上一些附加项的形式。证明这些附加项是一个全时间导数。

因此，在任何匀速运动的坐标系中，动能都可以取为 $T = \sum_\alpha \frac{1}{2} m_\alpha v_\alpha^2$。
