### 1.5 欧拉-拉格朗日方程 (The Euler–Lagrange Equations)

**平稳作用量原理** (principle of stationary action) 将位形空间中可实现的系统路径刻画为那些使作用量取**平稳值** (stationary value) 的路径。在基础微积分中，我们学到函数的**临界点** (critical points) 是其导数为零的点。与此类似，使作用量保持平稳的路径，是某个微分方程组的解。这个方程组被称为**欧拉-拉格朗日方程** (Euler–Lagrange equations)，或简称**拉格朗日方程** (Lagrange equations)。它是一个纽带，使我们能够运用平稳作用量原理来计算力学系统的运动，并将力学的变分表述与牛顿表述联系起来。

-----

#### **拉格朗日方程**

我们会发现，如果 $L$ 是一个依赖于时间、坐标和速度的系统拉格朗日量，并且 $q$ 是一条坐标路径，其作用量 $S[q](t_1, t_2)$ 在此路径上为平稳（相对于任何保持路径端点固定的变分而言），那么：

$$
D(\partial_2 L \circ \Gamma[q]) - \partial_1 L \circ \Gamma[q] = 0.
\tag{1.12}
$$

在这里，$L$ 是一个局域元组的实值函数；$\partial_1 L$ 和 $\partial_2 L$ 分别表示 $L$ 对其**广义位置**参数和**广义速度**参数的偏导数。⁴⁷ 函数 $\partial_2 L$ 将一个局域元组映射到一个结构，其分量是 $L$ 对广义速度的每个分量的导数。函数 $\Gamma[q]$ 将时间映射到局域元组：$\Gamma[q](t) = (t, q(t), Dq(t), \dots)$。因此，复合函数 $\partial_1 L \circ \Gamma[q]$ 和 $\partial_2 L \circ \Gamma[q]$ 都是时间 $t$ 这一个参数的函数。拉格朗日方程断言，在任何时刻，$\partial_2 L \circ \Gamma[q]$ 的导数等于 $\partial_1 L \circ \Gamma[q]$。给定一个拉格朗日量，拉格朗日方程就构成了一个可实现路径必须满足的常微分方程组。

拉格朗日方程传统上被写作关于 $q$ 的每个分量的独立方程：

$$\\frac{d}{dt} \\frac{\\partial L}{\\partial \\dot{q}\_i} - \\frac{\\partial L}{\\partial q\_i} = 0 \\quad i=0, \\dots, n-1.
$$

在这种写法中，记法没有区分 $L$（一个三个变量 $t, q, \dot{q}$ 的实值函数）和 $L \circ \Gamma[q]$（一个实数变量 $t$ 的实值函数）。如果我们没有意识到这种记法上的歧义 (notational pun)，这些方程按字面意思是讲不通的——$\partial L / \partial \dot{q}$ 是三个变量的函数，因此在对这个表达式求 $d/dt$ 之前，我们必须将参数 $q, \dot{q}$ 视为 $t$ 的函数。类似地，$\partial L / \partial q$ 是三个变量的函数，在令它等于 $d/dt(\partial L / \partial \dot{q})$ 之前，我们必须将其视为 $t$ 的函数。

一种更明确的、正确使用传统记法的方式是：

$$
\frac{d}{dt} \left( \left. \frac{\partial L(t, w, \dot{w})}{\partial \dot{w}_i} \right|_{w=q(t), \dot{w} = \frac{dq(t)}{dt}} \right) - \left. \frac{\partial L(t, w, \dot{w})}{\partial w_i} \right|_{w=q(t), \dot{w} = \frac{dq(t)}{dt}} = 0,
$$

其中 $i = 0, \dots, n-1$。在这些方程中，我们看到，首先取拉格朗日函数 $L$ 的偏导数，然后将路径 $q$ 及其导数 $Dq$ 代入 $L$ 的位置和速度参数中，最终得到一个关于时间 $t$ 的表达式。

-----

### **1.5.1 拉格朗日方程的推导**

我们将证明，平稳作用量原理蕴含着可实现路径满足欧拉-拉格朗日方程。

#### **直接推导**

设 $q$ 是从 $(t_1, q(t_1))$ 到 $(t_2, q(t_2))$ 的一条可实现坐标路径。考虑邻近路径 $q + \epsilon\eta$，其中 $\eta(t_1) = \eta(t_2) = 0$。令

$$g(\\epsilon) = S[q + \\epsilon\\eta](t\_1, t\_2) = \\int\_{t\_1}^{t\_2} L(t, q(t) + \\epsilon\\eta(t), Dq(t) + \\epsilon D\\eta(t)) dt.
\\tag{1.13}
$$

将 $g(\epsilon)$ 在 $\epsilon=0$ 处展开为幂级数

$$
g(\epsilon) = g(0) + \epsilon Dg(0) + \dots
\tag{1.14}
$$

并使用链式法则，我们得到

$$Dg(0) = \\int\_{t\_1}^{t\_2} \\left{ (\\partial\_1 L \\circ \\Gamma[q]) \\eta + (\\partial\_2 L \\circ \\Gamma[q]) D\\eta \\right} dt.
\\tag{1.15}
$$

对第二项进行**分部积分** (integrating by parts)，我们得到

$$
\int_{t_1}^{t_2} (\partial_2 L \circ \Gamma[q]) D\eta dt = \left[ (\partial_2 L \circ \Gamma[q]) \eta \right]_{t_1}^{t_2} - \int_{t_1}^{t_2} D(\partial_2 L \circ \Gamma[q]) \eta dt.
\tag{1.16}
$$

由路径变分引起的作用量增量 $\Delta S$，在 $\epsilon$ 的一阶近似下为 $\epsilon Dg(0)$。由于 $\eta$ 在端点处为零，积分项（即 $\left[ \dots \right]_{t_1}^{t_2}$ 项）为零。将其他两项合并，并恢复到函数式记法，我们发现增量为：

$$\\Delta S = \\epsilon \\int\_{t\_1}^{t\_2} { \\partial\_1 L \\circ \\Gamma[q] - D(\\partial\_2 L \\circ \\Gamma[q]) } \\eta dt.
\\tag{1.17}
$$

如果 $\Delta S = 0$，则作用量是平稳的。我们在选择变分 $\eta$ 时保留了足够的自由度，这迫使积分中 $\eta$ 的乘子（即花括号内的项）在路径上的每一点都必须为零。我们用反证法来论证：假设这个因子在某个特定时刻不为零。那么它至少有一个分量不为零。但如果我们选择的 $\eta$ 是一个只在该时刻邻域内、在该分量上不为零，而在其他地方都为零的“凸起”函数，那么这个积分将不为零。因此，我们可以得出结论：花括号中的因子必定恒等于零，从而得到拉格朗日方程：⁴⁸

$$
D(\partial_2 L \circ \Gamma[q]) - \partial_1 L \circ \Gamma[q] = 0.
\tag{1.18}
$$

-----

#### **变分算子 (The Variation Operator)** ⚙️

首先，我们将开发一些工具来研究依赖于路径的函数 (path-dependent functions) 是如何随路径变分而变化的。然后，我们将把这些工具应用于作用量，以推导拉格朗日方程。

假设我们有一个依赖于路径 $q$ 的函数 $f[q]$。当路径 $q$ 发生变分时，这个函数 $f$ 如何变化？设 $q$ 为一条坐标路径，$q + \epsilon\eta$ 为一条变分路径，其中函数 $\eta$ 是一个可以加到路径 $q$ 上的类路径函数 (path-like function)，$\epsilon$ 是一个缩放因子。我们定义函数 $f$ 在路径 $q$ 上的**变分** $\delta_\eta f[q]$ 为：⁴⁹

$$
\delta_\eta f[q] = \lim_{\epsilon \to 0} \left( \frac{f[q + \epsilon\eta] - f[q]}{\epsilon} \right).
\tag{1.19}
$$

$f$ 的变分是函数 $f$ 随路径微小变分而变化的一阶线性近似。$f$ 的变分依赖于 $\eta$。

一个简单的例子是恒等路径函数 $I[q] = q$ 的变分。应用定义，我们发现：

$$\\delta\_\\eta I[q] = \\lim\_{\\epsilon \\to 0} \\left( \\frac{(q + \\epsilon\\eta) - q}{\\epsilon} \\right) = \\eta.
\\tag{1.20}
$$

传统上将 $\delta_\eta I[q]$ 简记为 $\delta q$。另一个例子是返回路径导数的路径函数。我们有：⁵⁰

$$
\delta_\eta g[q] = \lim_{\epsilon \to 0} \left( \frac{D(q + \epsilon\eta) - Dq}{\epsilon} \right) = D\eta \quad \text{其中 } g[q] = Dq.
\tag{1.21}
$$

传统上将 $\delta_\eta g[q]$ 记为 $\delta Dq$。

变分可以用导数来表示。令 $g(\epsilon) = f[q + \epsilon\eta]$；那么

$$\\delta\_\\eta f[q] = \\lim\_{\\epsilon \\to 0} \\left( \\frac{g(\\epsilon) - g(0)}{\\epsilon} \\right) = Dg(0).
\\tag{1.22}
$$

变分具有以下类似导数的性质。对于路径依赖函数 $f$ 和 $g$ 以及常数 $c$：

$$
\delta_\eta (fg)[q] = \delta_\eta f[q] g[q] + f[q] \delta_\eta g[q]
\tag{1.23}
$$

$$
\delta_\eta (f+g)[q] = \delta_\eta f[q] + \delta_\eta g[q]
\tag{1.24}
$$

$$
\delta_\eta (cf)[q] = c \delta_\eta f[q].
\tag{1.25}
$$

令 $F$ 为一个路径无关函数 (path-independent function)，$g$ 为一个路径依赖函数；那么

$$\\delta\_\\eta h[q] = (DF \\circ g[q]) \\delta\_\\eta g[q] \\quad \\text{其中 } h[q] = F \\circ g[q].
\\tag{1.26}
$$

算子 $D$（微分）和 $\delta$（变分）在以下意义上是**对易** (commute) 的：

$$
D \delta_\eta f[q] = \delta_\eta g[q] \quad \text{其中 } g[q] = D(f[q]).
\tag{1.27}
$$

变分在类似的意义上也与积分对易。

如果一个路径依赖函数 $f$ 对于特定路径 $q$ 相对于该路径的微小变化是平稳的，那么它对于由 $q$ 加上某个特定函数 $\eta$ 的微小倍数所产生的变分子集，也必定是平稳的。因此，$\delta_\eta f[q] = 0$ 对任意 $\eta$ 成立，这意味着函数 $f$ 对于 $q$ 附近的微小路径变分是平稳的。

-----

**练习 1.7：$\delta$ 的性质**
证明 $\delta$ 具有性质 (1.23)–(1.27)。

**练习 1.8：$\delta$ 的实现**
a. 假设我们有一个程序 `f` 实现了路径依赖函数：对于路径 `q` 和时间 `t`，其值为 `((f q) t)`。程序 `delta` 计算变分 $(\delta_\eta f)[q](t)$，其值为表达式 `((((delta eta) f) q) t)`。请完成 `delta` 的定义：

```scheme
(define (((delta eta) f) q)
...)
```

b. 使用你的 `delta` 程序，验证练习 1.7 中列出的 $\delta$ 的性质对于简单函数（如由程序 `f` 实现的函数）是否成立：⁵¹

```scheme
(define (f q)
(compose
(literal-function ’F
(-> (UP Real (UP* Real) (UP* Real)) Real))
(Gamma q)))
```

这实现了一个 $n$ 自由度的路径依赖函数，它在每一时刻都依赖于路径的局域元组。你可以定义一个字面的二维路径：

```scheme
(define q (literal-function ’q (-> Real (UP Real Real))))
```

你应该计算等式两边的值，然后将结果相减。答案应该是零。

-----

#### **使用变分算子推导**

作用量是拉格朗日量沿路径的积分：

$$S[q](t\_1, t\_2) = \\int\_{t\_1}^{t\_2} L \\circ \\Gamma[q].
\\tag{1.28}
$$

对于一条可实现的路径 $q$，作用量 $S$ 相对于任何保持端点（即 $\eta(t_1) = \eta(t_2) = 0$）的变分 $\eta$ 均为零：

$$
\delta_\eta S[q](t_1, t_2) = 0.
\tag{1.29}
$$

变分与积分对易，所以作用量的变分为：

$$\\delta\_\\eta S[q](t\_1, t\_2) = \\int\_{t\_1}^{t\_2} \\delta\_\\eta h[q] \\quad \\text{其中 } h[q] = L \\circ \\Gamma[q].
\\tag{1.30}
$$

根据方程 (1.20) 和 (1.21) 可知：

$$
\delta_\eta \Gamma[q](t) = (0, \eta(t), D\eta(t)),
\tag{1.31}
$$

再利用变分的链式法则 (1.26)，我们得到：⁵²

$$\\delta\_\\eta S[q](t\_1, t\_2) = \\int\_{t\_1}^{t\_2} { (\\partial\_1 L \\circ \\Gamma[q]) \\eta + (\\partial\_2 L \\circ \\Gamma[q]) D\\eta } dt.
\\tag{1.32}
$$

对方程 (1.32) 的最后一项进行分部积分，得到：

$$
\int_{t_1}^{t_2} (\partial_2 L \circ \Gamma[q]) D\eta dt = \left[ (\partial_2 L \circ \Gamma[q]) \eta \right]_{t_1}^{t_2} - \int_{t_1}^{t_2} D(\partial_2 L \circ \Gamma[q]) \eta dt.
\tag{1.33}
$$

对于我们的变分 $\eta$，我们有 $\eta(t_1) = \eta(t_2) = 0$，所以第一项（$\left[ \dots \right]_{t_1}^{t_2}$ 项）为零。

因此，作用量的变分为零，当且仅当：

$$0 = \\int\_{t\_1}^{t\_2} { (\\partial\_1 L \\circ \\Gamma[q]) - D(\\partial\_2 L \\circ \\Gamma[q]) } \\eta dt.
\\tag{1.34}
$$

作用量的变分为零，是因为我们假设了 $q$ 是一条可实现的路径。因此，(1.34) 必须对**任何**在端点处为零的函数 $\eta$ 都成立。由于 $\eta$ 除了在端点为零外是任意的，所以积分号内的方括号因子必须为零。所以：

$$
D(\partial_2 L \circ \Gamma[q]) - (\partial_1 L \circ \Gamma[q]) = 0.
\tag{1.35}
$$

这正是我们要得到的拉格朗日方程。

满足拉格朗日方程的路径，是使作用量保持平稳的路径。而作用量是否平稳这一事实，仅取决于 $L$ 在路径上每一点（以及在邻近路径上每一点）的值，而**不取决于**我们用来计算这些值的坐标系。

因此，如果系统的路径在某个特定坐标系中满足拉格朗日方程，那么它在**任何**坐标系中都必须满足拉格朗日方程。这就是说，变分力学方程的推导方式，在任何位形空间和任何坐标系中都是相同的。

-----

#### **示例 1：谐振子 (Harmonic oscillator)**

作为一个例子，考虑谐振子。其拉格朗日量为：

$$L(t, x, v) = \\frac{1}{2} m v^2 - \\frac{1}{2} k x^2.
\\tag{1.36}
$$

那么

$$
\partial_1 L(t, x, v) = -kx \quad \text{且} \quad \partial_2 L(t, x, v) = mv.
\tag{1.37}
$$

拉格朗日量 $L$ 作用于一个包含时间、坐标和速度的元组。符号 $t, x, v$ 是任意的；它们用于指定 $L$ 的形式参数。

现在假设我们有一条位形路径 $y$，它给出了振子在每个时刻 $t$ 的坐标 $y(t)$。在时刻 $t$ 相应局域元组的初始段是：

$$\\Gamma[suspicious link removed] = (t, y(t), Dy(t)).
\\tag{1.38}
$$

所以

$$
(\partial_1 L \circ \Gamma[y])(t) = -ky(t) \quad \text{且} \quad (\partial_2 L \circ \Gamma[y])(t) = mDy(t),
\tag{1.39}
$$

并且

$$D(\\partial\_2 L \\circ \\Gamma[y])(t) = m D^2 y(t),
\\tag{1.40}
$$

于是拉格朗日方程为：

$$
m D^2 y(t) + k y(t) = 0,
\tag{1.41}
$$

这正是谐振子的运动方程。

-----

#### **示例 2：轨道运动 (Orbital motion)**

作为另一个例子，考虑一个质量为 $m$ 的粒子绕一个固定引力中心进行二维运动，其引力势能为 $-\mu/r$，其中 $r$ 是到引力中心的距离。这被称为**开普勒问题** (Kepler problem)。

该问题的一个拉格朗日量是：⁵³

$$L(t; \\xi, \\eta; v\_\\xi, v\_\\eta) = \\frac{1}{2} m (v\_\\xi^2 + v\_\\eta^2) + \\frac{\\mu}{\\sqrt{\\xi^2 + \\eta^2}},
\\tag{1.42}
$$

其中 $\xi$ 和 $\eta$ 是粒子直角坐标的形式参数， $v_\xi$ 和 $v_\eta$ 是对应的直角速度分量的形式参数。那么

$$
\partial_1 L(t; \xi, \eta; v_\xi, v_\eta) = \left[ -\frac{\mu \xi}{(\xi^2 + \eta^2)^{3/2}}, -\frac{\mu \eta}{(\xi^2 + \eta^2)^{3/2}} \right].
\tag{1.43}
$$

类似地，

$$\\partial\_2 L(t; \\xi, \\eta; v\_\\xi, v\_\\eta) = [m v\_\\xi, m v\_\\eta].
\\tag{1.44}
$$

现在假设我们有一条位形路径 $q = (x, y)$，所以在时刻 $t$ 的坐标元组是 $q(t) = (x(t), y(t))$。在时刻 $t$ 局域元组的初始段是：

$$
\Gamma[q](t) = (t; x(t), y(t); Dx(t), Dy(t)).
\tag{1.45}
$$

所以

$$(\\partial\_1 L \\circ \\Gamma[q])(t) = \\left[ -\\frac{\\mu x(t)}{(x(t)^2 + y(t)^2)^{3/2}}, -\\frac{\\mu y(t)}{(x(t)^2 + y(t)^2)^{3/2}} \\right],
\\tag{1.46}
$$

并且

$$
D(\partial_2 L \circ \Gamma[q])(t) = [m D^2 x(t), m D^2 y(t)].
\tag{1.47}
$$

拉格朗日方程的分量形式在时刻 $t$ 为：

$$m D^2 x(t) = -\\frac{\\mu x(t)}{(x(t)^2 + y(t)^2)^{3/2}} \\quad \\text{且} \\quad m D^2 y(t) = -\\frac{\\mu y(t)}{(x(t)^2 + y(t)^2)^{3/2}}.
\\tag{1.48}
$$

-----

**练习 1.9：拉格朗日方程**
推导下列系统的拉格朗日方程，并像谐振子和轨道运动示例中那样，展示所有中间步骤。
a. 一个理想**平面摆** (planar pendulum) 由一个质量为 $m$ 的摆锤通过一根长度为 $l$ 的无质量杆连接到一个枢轴上，受到均匀重力加速度 $g$ 的作用。其拉格朗日量为 $L(t, \theta, \dot{\theta}) = \frac{1}{2} m l^2 \dot{\theta}^2 + m g l \cos\theta$。$L$ 的形式参数是 $t, \theta, \dot{\theta}$；$\theta$ 测量摆杆与铅垂线的夹角，$\dot{\theta}$ 是摆杆的角速度。⁵⁴
b. 一个质量为 $m$ 的粒子在二维势 $V(x, y) = (x^2 + y^2)/2 + x^2 y - y^3 / 3$ 中运动，其中 $x$ 和 $y$ 是粒子的直角坐标。其拉格朗日量为 $L(t; x, y; v_x, v_y) = \frac{1}{2} m (v_x^2 + v_y^2) - V(x, y)$。
c. 一个质量为 $m$、被约束在半径为 $R$ 的**球面**上运动的粒子，其拉格朗日量为 $L(t; \theta, \phi; \alpha, \beta) = \frac{1}{2} m R^2 (\alpha^2 + (\beta \sin\theta)^2)$。角度 $\theta$ 是粒子的**余纬** (colatitude)，$\phi$ 是**经度** (longitude)；$\alpha$ 是余纬的变化率，$\beta$ 是经度的变化率。

**练习 1.10：高阶导数拉格朗日量**
推导依赖于加速度的拉格朗日量的拉格朗日方程。具体来说，证明形式为 $L(t, q, \dot{q}, \ddot{q})$ 的拉格朗日量的拉格朗日方程为：⁵⁵

$$D^2(\\partial\_3 L \\circ \\Gamma[q]) - D(\\partial\_2 L \\circ \\Gamma[q]) + \\partial\_1 L \\circ \\Gamma[q] = 0.
\\tag{1.49}
$$

这些方程由泊松 (Poisson) 首先推导得出，通常会涉及 $q$ 的四阶导数。注意，其推导过程与不含加速度的拉格朗日方程的推导完全类似；只是更长。我们必须对变分施加什么限制，才能使临界路径满足一个微分方程？

-----

### **1.5.2 计算拉格朗日方程** 💻

计算拉格朗日方程的程序反映了函数表达式 (1.12)，其中程序 `Gamma` 实现了 $\Gamma$：⁵⁶

```scheme
(define ((Lagrange-equations Lagrangian) q)
  (- (D (compose ((partial 2) Lagrangian) (Gamma q)))
     (compose ((partial 1) Lagrangian) (Gamma q))))
```

`Lagrange-equations` 的参数是一个计算拉格朗日量的程序。`Lagrange-equations` 程序返回一个程序，当它作用于路径 `q` 时，会返回一个单参数（时间）的程序，该程序计算拉格朗日方程 (1.12) 的左侧。如果 $q$ 是一条使拉格朗日作用量平稳的路径，这些**残差** (residual values) 将为零。

请注意，`Lagrange-equations` 程序，就像拉格朗日方程本身一样，对**任何**广义坐标系都有效。当我们编写程序来研究特定系统时，实现拉格朗日函数和路径 $q$ 的程序将反映为表示该系统而选择的实际坐标，但我们在每种情况下都使用**相同**的 `Lagrange-equations` 程序。这种抽象反映了一个重要的事实：从拉格朗日量推导拉格朗日方程的方法始终是相同的；它与自由度的数量、位形空间的拓扑结构以及用于描述位形空间中各点的坐标系无关。

-----

#### **示例 1：自由粒子**

再次考虑自由粒子的情况。其拉格朗日量由程序 `L-free-particle` 实现。我们不必像 1.4 节那样数值积分和最小化作用量，而是可以对任意直线路径 $t \mapsto (at + a_0, bt + b_0, ct + c_0)$ 检验拉格朗日方程：

```scheme
(define (test-path t)
  (up (+ (* ’a t) ’a0)
      (+ (* ’b t) ’b0)
      (+ (* ’c t) ’c0)))

(((Lagrange-equations (L-free-particle ’m))
  test-path)
 ’t)
(down 0 0 0)
```

残差为零表明该测试路径满足拉格朗日方程。⁵⁷

我们也可以将 `Lagrange-equations` 程序应用于任意函数：⁵⁸

```scheme
(show-expression
 (((Lagrange-equations (L-free-particle ’m))
   (literal-function ’x))
  ’t))
```

(\*(((expt D 2) x) t) m)

$$
m D^2 x(t)
$$

结果是一个包含任意时间 $t$ 和质量 $m$ 的表达式，它为零当且仅当 $D^2 x = 0$，这正是自由粒子的预期方程。

-----

#### **示例 2：谐振子**

再次考虑谐振子，其拉格朗日量为 (1.10)。我们知道谐振子的运动是具有给定振幅、频率和相位的正弦波：

$$x(t) = A \\cos(\\omega t + \\phi).
$$

假设我们忘记了
解中的常数与振子的质量 $m$ 和弹簧常数 $k$ 是如何关联的。让我们代入这个提议的解，看看残差：

```scheme
(define (proposed-solution t)
  (* ’A (cos (+ (* ’omega t) ’phi))))

(show-expression
 (((Lagrange-equations (L-harmonic ’m ’k))
   proposed-solution)
  ’t))
```

$$
\cos(\omega t + \phi) A (k - m \omega^2)
\tag{1.50}
$$

这里的残差表明，对于非零振幅，唯一允许的解是 $(k - m \omega^2) = 0$ 或 $\omega = \sqrt{k/m}$ 的解。

-----

**练习 1.11：开普勒第三定律**
一个适用于研究两个粒子（质量分别为 $m_1$ 和 $m_2$）在势能 $V$ 下相对运动的拉格朗日量是：

```scheme
(define ((L-central-polar m V) local)
(let ((q (coordinate local))
(qdot (velocity local)))
(let ((r (ref q 0))      (phi (ref q 1))
(rdot (ref qdot 0)) (phidot (ref qdot 1)))
(- (* 1/2 m
(+ (square rdot) (square (* r phidot))) )
(V r)))))
```

参数 $m$ 是系统的**折合质量** (reduced mass)：

$$m = \\frac{m\_1 m\_2}{m\_1 + m\_2}.
\\tag{1.51}
$$

对于引力，势能函数为

```scheme
(define ((gravitational-energy G m1 m2) r)
  (- (/ (* G m1 m2) r)))
```

其中 $r$ 是两个粒子之间的距离。

考虑粒子围绕它们共同的质心做**圆轨道**运动的简单情况。构造一个圆轨道路径，并将其代入拉格朗日方程。证明残差给出了**开普勒定律**：

$$
n^2 a^3 = G (m_1 + m_2)
\tag{1.52}
$$

其中 $n$ 是轨道的角频率，$a$ 是两个粒子之间的距离。

**练习 1.12：拉格朗日方程**
使用 `Lagrange-equations` 程序，计算**练习 1.9** 中拉格朗日量的拉格朗日方程。此外，使用计算机执行 `Lagrange-equations` 程序中的每一步，并显示中间结果。将这些步骤与你在**练习 1.9** 的手写推导中展示的步骤联系起来。

**练习 1.13：高阶导数拉格朗日量**
a. 编写一个程序，用于计算依赖于加速度的拉格朗日量（如**练习 1.10** 中）的拉格朗日方程。注意，`Gamma` 可以接受一个可选参数，指定所需局域元组初始段的长度。默认长度是 3，给出局域元组中直到（并包括）速度的分量。
b. 使用你的程序计算拉格朗日量

$$L(t, x, v, a) = -\\frac{1}{2} m x a - \\frac{1}{2} k x^2
$$

的拉格朗日方程。你认出最终得到的运动方程吗？
c. 为了更多乐趣，编写一个通用的拉格朗日方程程序，它接受一个依赖于任意阶导数的拉格朗日量以及导数的阶数，以产生所需的运动方程。
